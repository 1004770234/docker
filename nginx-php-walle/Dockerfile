FROM idoall/nginx-php
MAINTAINER lion <lion.net@163.com>


ADD composer1.2.4.phar /home/work/_src/composer.phar

# -----------------------------------------------------------------------------
# 安装 composer 1.2.4
# -----------------------------------------------------------------------------
RUN cd /home/work/_src/ \
    && mv composer.phar /usr/local/bin/composer \
    && chmod +x /usr/local/bin/composer

# -----------------------------------------------------------------------------
# 安装 ansible
# -----------------------------------------------------------------------------
RUN yum clean all \
    && yum makecache \
    && yum install -y ansible \

# -----------------------------------------------------------------------------
# 安装 walle-web 1.2.0
# -----------------------------------------------------------------------------
 ADD walle-web-1.2.0.tar.gz /home/work/_site/walle-web
    && mkdir -p /home/work/_site/walle-web \
    && cd /home/work/_site/walle-web
    \
# -----------------------------------------------------------------------------
# 删除多余文件
# -----------------------------------------------------------------------------
    && mkdir -p /home/work/_script/ \
    && yum clean all \
    && rm -rf /home/work/_src/*


# -----------------------------------------------------------------------------
# 通过supervisor启动 php5-fpm
# 添加nginx配置文件可以浏览PHP
# -----------------------------------------------------------------------------
ADD _app /home/work/_app